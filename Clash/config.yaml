# é…ç½®åŸä½œè€…: CentralSubscription3
# ä»“åº“åœ°å€ï¼šhttps://github.com/Centralmatrix3/Matrix-io/raw/master/Clash/Matrix.yaml

mixed-port: 7890        # Mixed ç«¯å£
allow-lan: true         # å…è®¸å±€åŸŸç½‘è¿æ¥
mode: Rule              # è§„åˆ™æ¨¡å¼
log-level: info         # æ—¥å¿—çº§åˆ«
ipv6: false             # IPv6å¼€å…³

# å¤–éƒ¨æ§åˆ¶å™¨
external-controller: 127.0.0.1:9090

# DNSè®¾ç½®
dns:
  enable: false         # ç¦ç”¨ç³»ç»Ÿ DNS
  ipv6: false           # è§£æå¼€å…³ IPv6
  listen: 0.0.0.0:1053  # DNS ç›‘å¬
  default-nameserver:   # å¸¸è§„ DNS
    - 223.5.5.5
  nameserver:           # åŠ å¯† DNS
    - https://dns.alidns.com/dns-query
    # - quic://dns.alidns.com   # å¦‚æœä½¿ç”¨Mihomoï¼ˆåŸClash.Metaå†…æ ¸å¯ä»¥æ”¹ç”¨è¿™ä¸ªDNSï¼‰

# å¢å¼ºæ¨¡å¼:fake-ipæˆ–redir-host
  enhanced-mode: fake-ip

# fake-ip:èŒƒå›´å’Œè¿‡æ»¤
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*.lan"
    - localhost.ptlogin2.qq.com
    - +.srv.nintendo.net
    - +.stun.playstation.net
    - +.msftconnecttest.com
    - +.msftncsi.com
    - +.xboxlive.com
    - msftconnecttest.com
    - xbox.*.microsoft.com
    - "*.battlenet.com.cn"
    - "*.battlenet.com"
    - "*.blzstatic.cn"
    - "*.battle.net"
    - "time.microsoft.com"
    - "time.apple.com"
  # fallback-filter:      # å›é€€è¿‡æ»¤å™¨
  #   geoip: true         # GEOIP å¯ç”¨
  #   geoip-code: CN      # GEOIP ç¼–ç 
  #   ipcidr:             # IPCIDR
  #     - 240.0.0.0/4
  #     - 0.0.0.0/32

# æ›´æ”¹GEOIPæ•°æ®åº“
geox-url:
  mmdb: "https://github.com/Loyalsoldier/geoip/raw/release/Country.mmdb"

# ä»£ç†
proxies: null

# ä»£ç†ä¾›åº”å•†
proxy-providers:
  Subscription:
    type: http
    url: "è®¢é˜…é“¾æ¥" # ğŸ§¸
    interval: 3600
    path: ./server/Subscription.yaml
    health-check:
      enable: true
      url: https://cp.cloudflare.com/generate_204
      interval: 600

# ä»£ç†ç­–ç•¥ç»„
proxy-groups:
  - name: Proxy
    type: select
    proxies:
      - é¦™æ¸¯
      - å°æ¹¾
      - æ—¥æœ¬
      - æ–°åŠ å¡
      - ç¾å›½
    use:
      - Subscription

  - name: "é¦™æ¸¯"
    type: url-test
    filter: "é¦™æ¸¯|æ¸¯|HK|ğŸ‡­ğŸ‡°|(?i)Hong"
    use:
      - Subscription
    url: "https://cp.cloudflare.com/generate_204"
    interval: 1800

  - name: "å°æ¹¾"
    type: url-test
    filter: "å°æ¹¾|å°|TW|ğŸ‡¹ğŸ‡¼|(?i)Taiwan"
    use:
      - Subscription
    url: "https://cp.cloudflare.com/generate_204"
    interval: 1800

  - name: "æ—¥æœ¬"
    type: url-test
    filter: "æ—¥æœ¬|æ—¥|JP|ğŸ‡¯ğŸ‡µ|(?i)Japan"
    use:
      - Subscription
    url: "https://cp.cloudflare.com/generate_204"
    interval: 1800

  - name: "æ–°åŠ å¡"
    type: url-test
    filter: "æ–°åŠ å¡|ç‹®|SG|ğŸ‡¸ğŸ‡¬|(?i)Singapore"
    use:
      - Subscription
    url: "https://cp.cloudflare.com/generate_204"
    interval: 1800

  - name: "ç¾å›½"
    type: url-test
    filter: "ç¾å›½|ç¾|US|ğŸ‡ºğŸ‡¸|(?i)States"
    use:
      - Subscription
    url: "https://cp.cloudflare.com/generate_204"
    interval: 1800

# è§„åˆ™é›†
rule-providers:
  Unbreak:
    behavior: classical
    interval: 86400
    type: http
    path: ./Ruleset/Unbreak.yaml
    url: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Clash/Ruleset/Unbreak.yaml

  AdBlock:
    behavior: domain
    interval: 86400
    type: http
    path: ./Ruleset/AdBlock.yaml
    url: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Clash/Ruleset/AdBlock.yaml

  Global:
    behavior: classical
    interval: 86400
    type: http
    path: ./Ruleset/Global.yaml
    url: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Clash/Ruleset/Global.yaml

  direct:
    behavior: domain
    interval: 86400
    type: http
    path: ./ruleset/direct.yaml
    url: "https://github.com/Loyalsoldier/clash-rules/raw/release/direct.txt"

  LAN:
    behavior: classical
    interval: 86400
    type: http
    path: ./Ruleset/LAN.yaml
    url: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Clash/Ruleset/LAN.yaml

# è§„åˆ™
rules:
  - DOMAIN,clash.razord.top,DIRECT
  - DOMAIN,yacd.haishan.me,DIRECT
  - RULE-SET,Unbreak,DIRECT
  - RULE-SET,AdBlock,REJECT
  - DOMAIN-KEYWORD,klei,DIRECT
  - DOMAIN-KEYWORD,github,Proxy
  - RULE-SET,Global,Proxy
  - RULE-SET,direct,DIRECT
  - GEOIP,TELEGRAM,DIRECT
  - GEOIP,LAN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,Proxy